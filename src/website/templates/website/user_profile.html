{% extends 'website/base.html' %}

{% block title %}{{ profile_user.username }}'s Profile - Broadcast App{% endblock %}

{% block content %}
<h2>{{ profile_user.username }}'s Profile</h2>

<div style="margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 4px;">
    <h4>User Information:</h4>
    <p><strong>Username:</strong> {{ profile_user.username }}</p>
    <p><strong>Name:</strong> {{ profile_user.first_name }} {{ profile_user.last_name }}</p>
    <p><strong>Email:</strong> {{ profile_user.email }}</p>
    <p><strong>Date Joined:</strong> {{ profile_user.date_joined|date:"F j, Y" }}</p>
    
    {% if profile_user.profile.house_number or profile_user.profile.building_number or profile_user.profile.society %}
        <h5>Address:</h5>
        {% if profile_user.profile.house_number %}
            <p><strong>House Number:</strong> {{ profile_user.profile.house_number }}</p>
        {% endif %}
        {% if profile_user.profile.building_number %}
            <p><strong>Building Number:</strong> {{ profile_user.profile.building_number }}</p>
        {% endif %}
        {% if profile_user.profile.society %}
            <p><strong>Society:</strong> {{ profile_user.profile.society }}</p>
        {% endif %}
    {% endif %}
    
    {% if user == profile_user %}
        <div style="margin-top: 15px;">
            <a href="{% url 'profile_edit' %}" class="btn btn-primary">Edit Profile</a>
        </div>
    {% endif %}
</div>

<div style="margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 4px;">
    <h4>Stats:</h4>
    <p>Posts: {{ posts.count }}</p>
    <p>Subscribers: {{ profile_user.subscribers.count }}</p>
    <p>Following: {{ profile_user.subscriptions.count }}</p>
</div>

{% if user.is_authenticated and user != profile_user %}
    <div style="margin-bottom: 20px;">
        {% if is_subscribed %}
            <a href="{% url 'unsubscribe' profile_user.id %}" class="btn btn-danger">Unfollow</a>
        {% else %}
            <a href="{% url 'subscribe' profile_user.id %}" class="btn btn-success">Follow</a>
        {% endif %}
    </div>
{% endif %}

<h3>Posts by {{ profile_user.username }}</h3>

{% if posts %}
    {% for post in posts %}
    <div class="post">
        <h4>{{ post.title }}</h4>
        <div class="timestamp">
            Published: {{ post.scheduled_for|date:"F j, Y, g:i a" }}
        </div>
        <p>{{ post.content }}</p>
        {% if post.image %}
            <img src="{{ post.image.url }}" alt="Post image">
        {% endif %}
    </div>
    {% endfor %}
{% else %}
    <p>{{ profile_user.username }} hasn't published any posts yet.</p>
{% endif %}

<div style="margin-top: 20px;">
    <a href="{% url 'home' %}" class="btn btn-primary">Back to Home</a>
</div>
{% endblock %} 